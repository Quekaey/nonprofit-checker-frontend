<mat-card class="checker-card">
  <form [formGroup]="form" (ngSubmit)="submit()">
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>EIN</mat-label>
      <input matInput formControlName="ein" placeholder="Enter EIN" />
      <mat-error *ngIf="form.get('ein')?.hasError('required')">
        EIN is required
      </mat-error>
    </mat-form-field>

    <button
      mat-raised-button
      color="primary"
      type="submit"
      [disabled]="loading"
    >
      Check Compliance
    </button>
  </form>

  <div *ngIf="loading" class="loading-container">
    <mat-progress-spinner
      diameter="48"
      mode="indeterminate"
    ></mat-progress-spinner>
  </div>

  <mat-card *ngIf="error" class="error-card">
    <mat-card-content>
      {{ error }}
    </mat-card-content>
  </mat-card>

  <mat-card *ngIf="data" class="result-card">
    <mat-card-title>Result</mat-card-title>
    <mat-card-content>
      <p><strong>Name:</strong> {{ data.name }}</p>
      <p><strong>Status:</strong> {{ data.complianceStatus }}</p>
      <p><strong>BMF/PUB78:</strong> {{ data.bmfPub78 }}</p>
    </mat-card-content>
  </mat-card>

  <mat-card *ngIf="history?.length" class="history-card">
    <mat-card-title>Recent Searches</mat-card-title>
    <mat-list>
      <mat-list-item *ngFor="let h of history">
        {{ h.timestamp | date : "short" }} â€” EIN: {{ h.query.ein }}
      </mat-list-item>
    </mat-list>
  </mat-card>
</mat-card>
